<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Demo Menu + QRIS Scanner</title>
<style>
  :root{
    --primary:#1e90ff;
    --text:#0f172a;
    --muted:#64748b;
    --bg:#f1f5f9;
    --card:#ffffff;
  }
  *{box-sizing:border-box}
  body{
    margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    background:var(--bg); color:var(--text);
  }

  /* ===== Layout 1 (hanya teks "Menu") ===== */
  header{
    padding:16px 20px; background:linear-gradient(90deg,#7c3aed,#3b82f6); color:#fff;
  }
  .balance-card{
    background:#fff; color:#111; border-radius:14px; padding:14px; box-shadow:0 6px 18px rgba(0,0,0,.08);
  }
  .menu-trigger{
    appearance:none; border:0; background:none; color:#fff; font-size:18px; padding:8px 0;
    cursor:pointer; text-decoration:underline; text-underline-offset:3px;
  }

  /* ===== Overlay: Layout 2 (full layar putih, grid kotak + icon) ===== */
  .overlay{
    position:fixed; inset:0; background:#fff; display:none; z-index:50;
  }
  .overlay.active{ display:block; }
  .overlay-header{
    display:flex; align-items:center; justify-content:space-between;
    padding:16px 16px; border-bottom:1px solid #e5e7eb;
  }
  .overlay-title{ font-weight:700; font-size:18px; }
  .close-btn{
    appearance:none; border:0; background:#e5e7eb; width:36px; height:36px; border-radius:10px;
    cursor:pointer; font-size:18px; display:grid; place-items:center;
  }
  .menu-grid{
    padding:16px; display:grid; grid-template-columns:repeat(3, 1fr); gap:12px;
    max-width:560px; margin:0 auto;
  }
  .menu-card{
    background:var(--card); border:1px solid #e5e7eb; border-radius:14px; padding:12px;
    display:flex; flex-direction:column; align-items:center; gap:8px; text-align:center;
    box-shadow:0 6px 14px rgba(0,0,0,.04); cursor:pointer; transition:transform .12s ease, box-shadow .12s ease;
  }
  .menu-card:hover{ transform:translateY(-2px); box-shadow:0 10px 20px rgba(0,0,0,.08); }
  .icon-wrap{
    width:42px; height:42px; border-radius:12px; display:grid; place-items:center;
    background:#eaf2ff; /* biru muda */
  }
  .menu-text{ font-size:12px; line-height:1.2; }

  /* ===== Scanner overlay ===== */
  .scanner{
    position:fixed; inset:0; background:#000; color:#fff; display:none; z-index:60;
    display:flex; flex-direction:column;
  }
  .scanner.active{ display:flex; }
  .scanner-bar{
    display:flex; align-items:center; justify-content:space-between; padding:10px 12px; background:rgba(0,0,0,.35);
  }
  .scanner-title{ font-weight:600; }
  .scanner-close{ appearance:none; border:0; background:#ffffff22; color:#fff; border-radius:10px; padding:8px 12px; cursor:pointer; }
  .preview{
    position:relative; flex:1; display:grid; place-items:center; overflow:hidden;
  }
  video{
    width:100%; height:100%; object-fit:cover;
  }
  .scan-guide{
    position:absolute; width:72vw; max-width:360px; aspect-ratio:1/1; border:2px solid rgba(255,255,255,.7);
    border-radius:14px;
  }
  .scanner-footer{
    padding:12px; background:#000; display:grid; gap:8px;
  }
  .fallback{
    display:flex; gap:8px; align-items:center; justify-content:center; flex-wrap:wrap;
  }
  .btn{
    appearance:none; border:0; border-radius:12px; padding:10px 14px; cursor:pointer; font-weight:600;
  }
  .btn-primary{ background:var(--primary); color:#fff; }
  .btn-ghost{ background:#ffffff10; color:#fff; border:1px solid #ffffff33; }
  .hint{ font-size:12px; color:#cbd5e1; text-align:center; }
</style>
</head>
<body>

  <!-- ===== Layout 1: hanya teks "Menu" ===== -->
  <header>
    <div style="display:flex; align-items:center; justify-content:space-between;">
      <div>
        <div style="opacity:.85; font-size:12px;">Selamat Datang</div>
        <div style="font-weight:700;">dapa</div>
      </div>
      <button id="openMenu" class="menu-trigger">Menu</button>
    </div>

    <div class="balance-card" style="margin-top:12px;">
      <div style="font-size:12px; color:#6b7280;">Saldo DANA</div>
      <div style="font-size:24px; font-weight:800;">Rp <span id="balance">130.500</span></div>
      <div style="margin-top:6px; font-size:12px; color:#6b7280;">Termasuk saldo DANA akun demo Rp1.000.000</div>
    </div>
  </header>

  <!-- ===== Overlay Layout 2: grid kotak + icon ===== -->
  <div id="menuOverlay" class="overlay" aria-hidden="true">
    <div class="overlay-header">
      <div class="overlay-title">Menu</div>
      <button class="close-btn" id="closeMenu" aria-label="Tutup">âœ•</button>
    </div>

    <div class="menu-grid">
      <!-- Contoh beberapa menu; tambah sesuka kamu -->
      <div class="menu-card" data-action="pulsa">
        <div class="icon-wrap">
          <!-- antenna -->
          <svg width="22" height="22" viewBox="0 0 24 24" fill="#2563eb" aria-hidden="true">
            <path d="M3 18h2v3H3v-3Zm4-5h2v8H7v-8Zm4-6h2v14h-2V7Zm4-5h2v19h-2V2Zm4 9h2v10h-2V11Z"/>
          </svg>
        </div>
        <div class="menu-text">Pulsa/Data</div>
      </div>

      <div class="menu-card" data-action="listrik">
        <div class="icon-wrap" style="background:#fff7ed; border:1px solid #fed7aa;">
          <!-- petir -->
          <svg width="22" height="22" viewBox="0 0 24 24" fill="#f59e0b" aria-hidden="true">
            <path d="M11 21v-7H7l6-11v7h4l-6 11z"/>
          </svg>
        </div>
        <div class="menu-text">Listrik</div>
      </div>

      <div class="menu-card" id="openScanner">
        <div class="icon-wrap" style="background:#eefdf3; border:1px solid #bbf7d0;">
          <!-- qr -->
          <svg width="22" height="22" viewBox="0 0 24 24" fill="#16a34a" aria-hidden="true">
            <path d="M3 3h8v8H3V3Zm2 2v4h4V5H5Zm6 6h4v2h-4v-2Zm6 0h4v4h-4v-4Zm0 6h2v4h-2v-4Zm-6 0h4v2h-4v-2ZM3 13h2v8H3v-8Zm6 4h2v4H9v-4Zm10 4h2v2h-2v-2Z"/>
          </svg>
        </div>
        <div class="menu-text">QRIS Scanner</div>
      </div>

      <div class="menu-card" data-action="topup">
        <div class="icon-wrap" style="background:#eaf2ff;">
          <!-- plus -->
          <svg width="22" height="22" viewBox="0 0 24 24" fill="#1e90ff"><path d="M11 5h2v6h6v2h-6v6h-2v-6H5v-2h6z"/></svg>
        </div>
        <div class="menu-text">Top Up</div>
      </div>

      <div class="menu-card" data-action="tarik">
        <div class="icon-wrap" style="background:#f0f9ff; border:1px solid #bae6fd;">
          <!-- arrow down -->
          <svg width="22" height="22" viewBox="0 0 24 24" fill="#0284c7"><path d="M12 3v12.17l4.59-4.58L18 12l-6 6-6-6 1.41-1.41L11 15.17V3h1z"/></svg>
        </div>
        <div class="menu-text">Tarik Uang</div>
      </div>

      <div class="menu-card" data-action="voucher">
        <div class="icon-wrap" style="background:#f5f3ff; border:1px solid #ddd6fe;">
          <!-- ticket -->
          <svg width="22" height="22" viewBox="0 0 24 24" fill="#7c3aed"><path d="M2 10h4a2 2 0 1 0 0-4h12a2 2 0 1 0 0 4h4v4h-4a2 2 0 1 0 0 4H6a2 2 0 1 0 0-4H2v-4z"/></svg>
        </div>
        <div class="menu-text">Voucher</div>
      </div>

      <!-- Tambahan contoh item -->
      <div class="menu-card"><div class="icon-wrap"><svg width="22" height="22" viewBox="0 0 24 24" fill="#1e90ff"><circle cx="12" cy="12" r="10"/></svg></div><div class="menu-text">Game</div></div>
      <div class="menu-card"><div class="icon-wrap"><svg width="22" height="22" viewBox="0 0 24 24" fill="#1e90ff"><rect x="4" y="4" width="16" height="16" rx="3"/></svg></div><div class="menu-text">Tagihan</div></div>
      <div class="menu-card"><div class="icon-wrap"><svg width="22" height="22" viewBox="0 0 24 24" fill="#1e90ff"><path d="M3 6h18v2H3V6zm0 5h18v2H3v-2zm0 5h12v2H3v-2z"/></svg></div><div class="menu-text">Lainnya</div></div>
    </div>
  </div>

  <!-- ===== Scanner (fullscreen black) ===== -->
  <div id="scanner" class="scanner" aria-hidden="true">
    <div class="scanner-bar">
      <div class="scanner-title">QRIS Scanner</div>
      <button id="closeScanner" class="scanner-close">Tutup</button>
    </div>
    <div class="preview">
      <video id="video" playsinline muted></video>
      <div class="scan-guide" aria-hidden="true"></div>
    </div>
    <div class="scanner-footer">
      <div class="fallback">
        <input id="fileInput" type="file" accept="image/*" capture="environment" class="btn btn-ghost" />
        <button id="switchCam" class="btn btn-ghost">Ganti Kamera</button>
      </div>
      <div id="scanMsg" class="hint">Jika preview tidak muncul, pastikan membuka lewat HTTPS dan izinkan kamera.</div>
    </div>
  </div>

<script>
  // ===== Menu overlay =====
  const menuOverlay = document.getElementById('menuOverlay');
  const openMenuBtn = document.getElementById('openMenu');
  const closeMenuBtn = document.getElementById('closeMenu');

  openMenuBtn.addEventListener('click', () => menuOverlay.classList.add('active'));
  closeMenuBtn.addEventListener('click', () => menuOverlay.classList.remove('active'));

  // ===== Scanner =====
  const scanner = document.getElementById('scanner');
  const openScannerCard = document.getElementById('openScanner');
  const closeScannerBtn = document.getElementById('closeScanner');
  const video = document.getElementById('video');
  const msg = document.getElementById('scanMsg');
  const switchCamBtn = document.getElementById('switchCam');
  const fileInput = document.getElementById('fileInput');

  let currentStream = null;
  let useBackCamera = true;

  function isSecureContextOK(){
    // https or localhost is considered secure by browser
    return window.isSecureContext || location.protocol === 'https:' || location.hostname === 'localhost';
  }

  async function startCamera(){
    try{
      if(!isSecureContextOK()){
        throw new Error('Browser mengharuskan HTTPS agar kamera aktif. Buka halaman ini via HTTPS.');
      }
      // stop dulu kalau ada
      stopCamera();

      const constraints = {
        audio:false,
        video:{
          facingMode: useBackCamera ? { exact:"environment" } : "user"
        }
      };
      currentStream = await navigator.mediaDevices.getUserMedia(constraints);
      video.srcObject = currentStream;
      await video.play();
      msg.textContent = 'Arahkan kamera ke QR. (Ini contoh preview, pemindaian QR belum diaktifkan)';
    }catch(err){
      console.error(err);
      msg.textContent = err.message.includes('HTTPS')
        ? 'Kamera butuh HTTPS. Upload file ini ke GitHub Pages/hosting HTTPS, lalu coba lagi.'
        : 'Tidak bisa akses kamera. Coba izinkan kamera atau pakai tombol "Ambil Foto QR".';
    }
  }

  function stopCamera(){
    if(currentStream){
      currentStream.getTracks().forEach(t => t.stop());
      currentStream = null;
      video.srcObject = null;
    }
  }

  openScannerCard.addEventListener('click', async () => {
    // buka scanner, tutup overlay menu
    menuOverlay.classList.remove('active');
    scanner.classList.add('active');
    await startCamera();
  });

  closeScannerBtn.addEventListener('click', () => {
    stopCamera();
    scanner.classList.remove('active');
  });

  switchCamBtn.addEventListener('click', async () => {
    useBackCamera = !useBackCamera;
    await startCamera();
  });

  // Fallback: ambil foto QR (tidak decode, hanya contoh)
  fileInput.addEventListener('change', () => {
    if(fileInput.files?.length){
      msg.textContent = 'Gambar diambil. (Contoh) Untuk decode QR, tambahkan library seperti jsQR/ZXing.';
    }
  });
</script>
</body>
</html>
